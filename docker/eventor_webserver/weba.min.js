!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.tracker=e()}}(function(){return function e(t,i,n){function o(s,c){if(!i[s]){if(!t[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=i[s]={exports:{}};t[s][0].call(d.exports,function(e){var i=t[s][1][e];return o(i?i:e)},d,d.exports,e,t,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,i){"use strict";var n=function(){function e(){}return e.prototype.merge=function(e,t){"object"!=typeof e&&(e={});for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];if("object"==typeof n){e[i]=this.merge(e[i],n);continue}e[i]=n}return e},e}();i.ObjectMerger=n},{}],2:[function(e,t,i){"use strict";var n=function(){function e(){}return e.prototype.access=function(e,t,i){return t.hasOwnProperty(e)?t[e]:i},e}();i.PropertyAccessor=n},{}],3:[function(e,t,i){"use strict";var n=function(){function e(){}return e.prototype.getDomain=function(e){return"//"+e.split("/")[2]},e.prototype.getParams=function(e){var t,i=this._getQueryParams(e),n={};if(!i)return n;for(var o=this._splitParams(i),r=0;r<o.length;r++)t=o[r].split("="),n[t[0]]=t[1];return n},e.prototype._getQueryParams=function(e){return e.replace(/^[^\?]+\??/,"")},e.prototype._splitParams=function(e){return e.split("&")},e}();i.UrlDecoder=n},{}],4:[function(e,t,i){"use strict";var n=function(){function e(){}return e.generate=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"===e?t:3&t|8;return i.toString(16)})},e}();i.Uuid=n},{}],5:[function(e,t,i){"use strict";var n=function(){function e(){this.sessionCookieName="_w_session",this.visitorCookieName="_w_visitor",this.sessionLifetimeInSeconds=1800,this.visitorLifetimeInSeconds=31104e3}return e}();i.Config=n},{}],6:[function(e,t,i){"use strict";var n=e("./Config"),o=function(){function e(e){this.urlDecoder=e}return e.prototype.read=function(e){var t=new n.Config,i=this.urlDecoder.getParams(e.src);return i.hasOwnProperty("t")&&i.hasOwnProperty("g")&&(t.trackerId=i.t,t.globalFunctionName=i.g),t.domain=this.urlDecoder.getDomain(e.src),t},e}();i.ConfigReader=o},{"./Config":5}],7:[function(e,t,i){"use strict";var n=function(){function e(){this.items={}}return e.prototype.get=function(e){if(!this._has(e))throw new Error('Identifier "'+e+'" is not defined.');var t=this.items[e];return t(this)},e.prototype.set=function(e,t){this.items[e]=t},e.prototype._has=function(e){return this.items.hasOwnProperty(e)},e}();i.Container=n},{}],8:[function(e,t,i){"use strict";var n=e("./Container"),o=e("../Config/ConfigReader"),r=e("../Tracker/Tracker"),s=e("../Model/Device/DeviceDetector"),c=e("../Model/Device/Detectors/ScreenSize/ScreenSizeDetector"),a=e("../Model/Device/Detectors/WindowSize/WindowSizeDetector"),u=e("../Model/Device/Detectors/LocalStorage/LocalStorageDetector"),d=e("../Model/Device/Detectors/SessionStorage/SessionStorageDetector"),l=e("../Model/Device/Detectors/AdBlock/AdBlockDetector"),f=e("../Model/Device/Detectors/Pdf/PdfDetector"),p=e("../Model/Device/Detectors/Canvas/CanvasDetector"),g=e("../Model/Device/Detectors/Flash/FlashDetector"),h=e("../Model/Device/Detectors/Silverlight/SilverlightDetector"),v=e("../Model/Device/Detectors/Cookie/CookieDetector"),m=e("../Model/Device/Detectors/Touch/TouchDetector"),D=e("../Model/Device/Detectors/QuickTime/QuickTimeDetector"),y=e("../Model/Device/Detectors/Java/JavaDetector"),w=e("../Model/Device/Detectors/RealPlayer/RealPlayerDetector"),S=e("../Model/ModelBuilder"),b=e("../Model/Device/DeviceBuilder"),C=e("../Model/Content/ContentBuilder"),T=e("../Model/Event/EventBuilder"),M=e("../Transport/TransportFactory"),P=e("../Serializer/SerializerFactory"),_=e("../Transport/Sender"),k=e("../Normalizer/ModelNormalizer"),A=e("../Model/CustomDimension/CustomDimensionsBuilder"),x=e("../Model/CustomMetric/CustomMetricsBuilder"),N=e("../Event/Handler/EventHandlerImpl"),z=e("../Transport/XhrTransport"),O=e("../Transport/PixelTransport"),E=e("../Transport/BeaconTransport"),B=e("../Common/UrlDecoder"),V=e("../Common/PropertyAccessor"),I=e("../Model/Visitor/VistitorBuilder"),R=e("../Model/Device/Detectors/Encoding/EncodingDetector"),j=e("../Model/Device/Detectors/Colors/ColorsDetector"),L=e("../Model/Device/Detectors/Language/LanguageDetector"),F=e("../Session/SessionManager"),H=e("../Session/Serializer/SessionCookieSerializer"),X=e("../Session/Storage/SessionCookieStorage"),Q=e("../Session/Serializer/VisitorCookieSerializer"),J=e("../Session/Storage/VisitorCookieStorage"),U=e("../Common/ObjectMerger");i.container=new n.Container;var W=window;i.container.set("w.url_decoder",function(){return new B.UrlDecoder}),i.container.set("w.config",function(e){var t=new o.ConfigReader(e.get("w.url_decoder"));return t.read(document.getElementsByTagName("script")[0])}),i.container.set("w.global",function(e){return W[e.get("w.config").globalFunctionName]}),i.container.set("w.model_builder",function(e){var t=new S.ModelBuilder;return t.addBuilder(new b.DeviceBuilder(e.get("w.device_detector"))),t.addBuilder(new C.ContentBuilder(document,e.get("w.property_accessor"))),t.addBuilder(new T.EventBuilder(e.get("w.config"))),t.addBuilder(new A.CustomDimensionsBuilder),t.addBuilder(new x.CustomMetricsBuilder),t.addBuilder(new I.VisitorBuilder(e.get("w.session_manager"))),t}),i.container.set("w.tracker",function(e){return new r.Tracker(e.get("w.global"),e.get("w.event_handler"),e.get("w.object_merger"))}),i.container.set("w.device_detector",function(){var e=new s.DeviceDetector;return e.addDetector(new c.ScreenSizeDetector(W)),e.addDetector(new a.WindowSizeDetector(W)),e.addDetector(new u.LocalStorageDetector(localStorage)),e.addDetector(new d.SessionStorageDetector(sessionStorage)),e.addDetector(new l.AdBlockDetector(W)),e.addDetector(new f.PdfDetector(W,navigator)),e.addDetector(new p.CanvasDetector(W)),e.addDetector(new g.FlashDetector(W,navigator)),e.addDetector(new h.SilverlightDetector(W,navigator)),e.addDetector(new v.CookieDetector(document,navigator)),e.addDetector(new m.TouchDetector(W,navigator)),e.addDetector(new D.QuickTimeDetector(navigator)),e.addDetector(new y.JavaDetector(navigator)),e.addDetector(new w.RealPlayerDetector(W,navigator)),e.addDetector(new R.EncodingDetector(document)),e.addDetector(new j.ColorsDetector(screen)),e.addDetector(new L.LanguageDetector(navigator)),e}),i.container.set("w.xhr_transport",function(e){return new z.XhrTransport(e.get("w.config"))}),i.container.set("w.pixel_transport",function(e){return new O.PixelTransport(e.get("w.config"))}),i.container.set("w.beacon_transport",function(e){return new E.BeaconTransport(navigator,e.get("w.config"))}),i.container.set("w.transport_factory",function(e){return new M.TransportFactory(e.get("w.xhr_transport"),e.get("w.pixel_transport"),e.get("w.beacon_transport"))}),i.container.set("w.normalizer",function(){return new k.ModelNormalizer}),i.container.set("w.serializer_factory",function(){return new P.SerializerFactory}),i.container.set("w.sender",function(e){return new _.Sender(e.get("w.transport_factory"),e.get("w.serializer_factory"),e.get("w.normalizer"))}),i.container.set("w.event_handler",function(e){return new N.EventHandlerImpl(e.get("w.sender"),e.get("w.model_builder"))}),i.container.set("w.property_accessor",function(){return new V.PropertyAccessor}),i.container.set("w.object_merger",function(){return new U.ObjectMerger}),i.container.set("w.session_cookie_serializer",function(e){return new H.SessionCookieSerializer(document,e.get("w.config"))}),i.container.set("w.visitor_cookie_serializer",function(e){return new Q.VisitorCookieSerializer(document,e.get("w.config"))}),i.container.set("w.session_cookie_storage",function(e){return new X.SessionCookieStorage(document,e.get("w.session_cookie_serializer"))}),i.container.set("w.visitor_cookie_storage",function(e){return new J.VisitorCookieStorage(document,e.get("w.visitor_cookie_serializer"))}),i.container.set("w.session_manager",function(e){return new F.SessionManager(e.get("w.session_cookie_storage"),e.get("w.visitor_cookie_storage"))})},{"../Common/ObjectMerger":1,"../Common/PropertyAccessor":2,"../Common/UrlDecoder":3,"../Config/ConfigReader":6,"../Event/Handler/EventHandlerImpl":9,"../Model/Content/ContentBuilder":11,"../Model/CustomDimension/CustomDimensionsBuilder":13,"../Model/CustomMetric/CustomMetricsBuilder":15,"../Model/Device/Detectors/AdBlock/AdBlockDetector":16,"../Model/Device/Detectors/Canvas/CanvasDetector":17,"../Model/Device/Detectors/Colors/ColorsDetector":18,"../Model/Device/Detectors/Cookie/CookieDetector":19,"../Model/Device/Detectors/Encoding/EncodingDetector":20,"../Model/Device/Detectors/Flash/FlashDetector":21,"../Model/Device/Detectors/Java/JavaDetector":22,"../Model/Device/Detectors/Language/LanguageDetector":23,"../Model/Device/Detectors/LocalStorage/LocalStorageDetector":24,"../Model/Device/Detectors/Pdf/PdfDetector":25,"../Model/Device/Detectors/QuickTime/QuickTimeDetector":26,"../Model/Device/Detectors/RealPlayer/RealPlayerDetector":27,"../Model/Device/Detectors/ScreenSize/ScreenSizeDetector":28,"../Model/Device/Detectors/SessionStorage/SessionStorageDetector":29,"../Model/Device/Detectors/Silverlight/SilverlightDetector":30,"../Model/Device/Detectors/Touch/TouchDetector":31,"../Model/Device/Detectors/WindowSize/WindowSizeDetector":32,"../Model/Device/DeviceBuilder":34,"../Model/Device/DeviceDetector":35,"../Model/Event/EventBuilder":37,"../Model/ModelBuilder":39,"../Model/Visitor/VistitorBuilder":41,"../Normalizer/ModelNormalizer":42,"../Serializer/SerializerFactory":46,"../Session/Serializer/SessionCookieSerializer":47,"../Session/Serializer/VisitorCookieSerializer":48,"../Session/SessionManager":51,"../Session/Storage/SessionCookieStorage":52,"../Session/Storage/VisitorCookieStorage":53,"../Tracker/Tracker":55,"../Transport/BeaconTransport":56,"../Transport/PixelTransport":57,"../Transport/Sender":58,"../Transport/TransportFactory":59,"../Transport/XhrTransport":61,"./Container":7}],9:[function(e,t,i){"use strict";var n=e("../../Transport/Transports"),o=e("../../Model/Model"),r=function(){function e(e,t){this.sender=e,this.modelBuilder=t}return e.prototype.handle=function(e){var t=new o.Model;this.modelBuilder.build(t,e),this.sender.send(n.Transports.PIXEL_TRANSPORT,t)},e}();i.EventHandlerImpl=r},{"../../Model/Model":38,"../../Transport/Transports":60}],10:[function(e,t,i){"use strict";var n=function(){function e(){}return e}();i.Content=n},{}],11:[function(e,t,i){"use strict";var n=e("./Content"),o=function(){function e(e,t){this.document=e,this.accessor=t}return e.prototype.build=function(e,t){var i=new n.Content;i.location=this.accessor.access("location",t,this.document.location.href),i.title=this.accessor.access("title",t,this.document.title),i.host=this.accessor.access("host",t,""),i.path=this.accessor.access("path",t,""),e.content=i},e}();i.ContentBuilder=o},{"./Content":10}],12:[function(e,t,i){"use strict";var n=function(){function e(e,t){this._index=e,this._value=t}return Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();i.CustomDimension=n},{}],13:[function(e,t,i){"use strict";var n=e("./CustomDimension"),o=function(){function e(){}return e.prototype.build=function(e,t){var i=new RegExp("dimension([1-9][0-9]?$|^100)");for(var o in t)if(t.hasOwnProperty(o)&&i.test(o)){var r=new n.CustomDimension(Number(o.replace("dimension","")),t[o]);e.addCustomDimension(r)}},e}();i.CustomDimensionsBuilder=o},{"./CustomDimension":12}],14:[function(e,t,i){"use strict";var n=function(){function e(e,t){this._index=e,this._value=t}return Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();i.CustomMetric=n},{}],15:[function(e,t,i){"use strict";var n=e("./CustomMetric"),o=function(){function e(){}return e.prototype.build=function(e,t){var i=new RegExp("metric([1-9][0-9]?$|^100)");for(var o in t)if(t.hasOwnProperty(o)&&i.test(o)){var r=new n.CustomMetric(Number(o.replace("metric","")),t[o]);e.addCustomMetric(r)}},e}();i.CustomMetricsBuilder=o},{"./CustomMetric":14}],16:[function(e,t,i){"use strict";var n="\n    pub_300x250\n    pub_300x250m\n    pub_728x90\n    text-ad\n    textAd\n    text_ad\n    text_ads\n    text-ads\n    text-ad-links\n",o="\n    width: 1px !important;\n    height: 1px !important;\n    position: absolute !important;\n    left: -10000px !important;\n    top: -1000px !important;\n",r=function(){function e(e){this.window=e}return e.prototype.detect=function(e){var t=!1;if(this.createBait(),this.detectAdBlock()&&(t=!0),void 0!==this.window.getComputedStyle&&!t){var i=this.window.getComputedStyle(this.bait,null);this.isHideByAdBlock(i)&&(t=!0)}this.destroyBait(),e.isAdBlock=t},e.prototype.createBait=function(){var e=this.window.document.createElement("div");e.setAttribute("class",n),e.setAttribute("style",o),this.bait=this.window.document.body.appendChild(e)},e.prototype.destroyBait=function(){this.window.document.body.removeChild(this.bait)},e.prototype.detectAdBlock=function(){return null!==this.window.document.body.getAttribute("abp")||null===this.bait.offsetParent||0===this.bait.offsetHeight||0===this.bait.offsetLeft||0===this.bait.offsetTop||0===this.bait.offsetWidth||0===this.bait.clientHeight||0===this.bait.clientWidth},e.prototype.isHideByAdBlock=function(e){return e&&("none"===e.getPropertyValue("display")||"hidden"===e.getPropertyValue("visibility"))},e}();i.AdBlockDetector=r},{}],17:[function(e,t,i){"use strict";var n=function(){function e(e){this.global=e}return e.prototype.detect=function(e){var t=this.global.document.createElement("canvas");e.isCanvas=!(!t.getContext||!t.getContext("2d"))},e}();i.CanvasDetector=n},{}],18:[function(e,t,i){"use strict";var n=function(){function e(e){this.screen=e}return e.prototype.detect=function(e){e.colors=this.screen.colorDepth},e}();i.ColorsDetector=n},{}],19:[function(e,t,i){"use strict";var n="w_test",o=function(){function e(e,t){this.document=e,this.navigator=t}return e.prototype.detect=function(e){var t=this.navigator.cookieEnabled;"undefined"!=typeof t&&t||(this.document.cookie=n,t=this.document.cookie.indexOf(n)!==-1,this.deleteCookie(n)),e.isCookie=t},e.prototype.deleteCookie=function(e){this.document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"},e}();i.CookieDetector=o},{}],20:[function(e,t,i){"use strict";var n=function(){function e(e){this.document=e}return e.prototype.detect=function(e){e.encoding=this.document.defaultCharset||document.charset||document.inputEncoding||document.characterSet},e}();i.EncodingDetector=n},{}],21:[function(e,t,i){"use strict";var n="ShockwaveFlash.ShockwaveFlash",o="Shockwave Flash",r=function(){function e(e,t){this.window=e,this.navigator=t}return e.prototype.detect=function(e){e.isFlash=void 0===this.navigator.plugins||0===this.navigator.plugins.length?!(!this.window.hasOwnProperty("ActiveXObject")||!new this.window.ActiveXObject(n)):void 0!==this.navigator.plugins[o]},e}();i.FlashDetector=r},{}],22:[function(e,t,i){"use strict";var n="javaEnabled",o=function(){function e(e){this.navigator=e}return e.prototype.detect=function(e){var t=!1;this.hasJavaEnabledMethod()&&(t=this.navigator.javaEnabled()),e.isJava=t},e.prototype.hasJavaEnabledMethod=function(){return this.navigator.hasOwnProperty(n)&&"function"==typeof this.navigator[n]},e}();i.JavaDetector=o},{}],23:[function(e,t,i){"use strict";var n=function(){function e(e){this.navigator=e}return e.prototype.detect=function(e){e.language=this.navigator.userLanguage||this.navigator.language},e}();i.LanguageDetector=n},{}],24:[function(e,t,i){"use strict";var n=function(){function e(e){this.localStorage=e}return e.prototype.detect=function(e){var t="w_localstorage_test";try{this.localStorage.setItem(t,!0),this.localStorage.removeItem(t),e.isLocalStorage=!0}catch(t){e.isLocalStorage=!1}},e}();i.LocalStorageDetector=n},{}],25:[function(e,t,i){"use strict";var n=["Adobe Acrobat","Chrome PDF Viewer","WebKit built-in PDF"],o=function(){function e(e,t){this.window=e,this.navigator=t}return e.prototype.detect=function(e){var t=this.canCreateActiveXObject("AcroPDF.PDF")||this.canCreateActiveXObject("PDF.PdfCtrl");if(!t)for(var i=n.length,o=0;o<i;o++)if(this.hasNavigatorPlugin(n[o])){t=!0;break}e.isPdf=t},e.prototype.canCreateActiveXObject=function(e){try{var t=this.window.ActiveXObject(e);return void 0!==t}catch(e){return!1}},e.prototype.hasNavigatorPlugin=function(e){if(this.navigator.plugins)for(var t in this.navigator.plugins)if(this.detectName(t,e))return!0;return!1},e.prototype.detectName=function(e,t){return this.navigator.plugins.hasOwnProperty(e)&&this.navigator.plugins[e].hasOwnProperty("name")&&this.navigator.plugins[e].name.indexOf(t)>-1},e}();i.PdfDetector=o},{}],26:[function(e,t,i){"use strict";var n="QuickTime",o=function(){function e(e){this.navigator=e}return e.prototype.detect=function(e){var t=!1;this.hasNavigatorPlugin(n)&&(t=!0),this.detectByOS()&&(t=!0),e.isQuickTime=t},e.prototype.hasNavigatorPlugin=function(e){if(this.navigator.plugins)for(var t in this.navigator.plugins)if(this.detectName(t,e))return!0;return!1},e.prototype.detectName=function(e,t){return this.navigator.plugins.hasOwnProperty(e)&&this.navigator.plugins[e].hasOwnProperty("name")&&this.navigator.plugins[e].name.indexOf(t)>-1},e.prototype.detectByOS=function(){return this.navigator.appVersion.indexOf("Mac")>0&&"Microsoft"===this.navigator.appName.substring(0,9)&&parseInt(this.navigator.appVersion,10)<5},e}();i.QuickTimeDetector=o},{}],27:[function(e,t,i){"use strict";var n=["RealPlayer(tm) G2 LiveConnect-Enabled Plug-In (32-bit)","RealPlayer(tm) G2 LiveConnect-Enabled Plug-In (64-bit)","RealPlayer Plugin"],o=["rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer"],r=function(){function e(e,t){this.navigator=t,this.window=e}return e.prototype.detect=function(e){for(var t=!1,i=o.length,r=0;r<i;r++)if(this.canCreateActiveXObject(o[r])){t=!0;break}if(!t)for(var s=n.length,c=0;c<s;c++)if(this.hasNavigatorPlugin(n[c])){t=!0;break}e.isRealPlayer=t},e.prototype.canCreateActiveXObject=function(e){try{var t=this.window.ActiveXObject(e);return void 0!==t}catch(e){return!1}},e.prototype.hasNavigatorPlugin=function(e){if(this.navigator.plugins)for(var t in this.navigator.plugins)if(this.detectName(t,e))return!0;return!1},e.prototype.detectName=function(e,t){return this.navigator.plugins.hasOwnProperty(e)&&this.navigator.plugins[e].hasOwnProperty("name")&&this.navigator.plugins[e].name.indexOf(t)>-1},e}();i.RealPlayerDetector=r},{}],28:[function(e,t,i){"use strict";var n=function(){function e(e){this.global=e}return e.prototype.detect=function(e){e.availableWidth=this.global.screen.width,e.availableHeight=this.global.screen.height},e}();i.ScreenSizeDetector=n},{}],29:[function(e,t,i){"use strict";var n=function(){function e(e){this.sessionStorage=e}return e.prototype.detect=function(e){var t="w_sessionstorage_test";try{this.sessionStorage.setItem(t,!0),this.sessionStorage.removeItem(t),e.isSessionStorage=!0}catch(t){e.isSessionStorage=!1}},e}();i.SessionStorageDetector=n},{}],30:[function(e,t,i){"use strict";var n="Silverlight Plug-In",o=function(){function e(e,t){this.window=e,this.navigator=t}return e.prototype.detect=function(e){var t=!1;try{var i=!1;try{t=!!this.navigator.plugins[n],t&&(i=!0)}catch(e){i=!1}if(i){var o=new this.window.ActiveXObject("AgControl.AgControl");t=!!o}}finally{e.isSilverlight=t}e.isSilverlight=t},e}();i.SilverlightDetector=o},{}],31:[function(e,t,i){"use strict";var n="touchstart",o=function(){function e(e,t){this.window=e,this.navigator=t}return e.prototype.detect=function(e){e.isTouch=n in this.window||!!this.navigator.msMaxTouchPoints},e}();i.TouchDetector=o},{}],32:[function(e,t,i){"use strict";var n=function(){function e(e){this.global=e}return e.prototype.detect=function(e){e.width=this.global.document.documentElement.clientWidth,e.height=this.global.document.documentElement.clientHeight},e}();i.WindowSizeDetector=n},{}],33:[function(e,t,i){"use strict";var n=function(){function e(){this.isJavascript=!0}return e}();i.Device=n},{}],34:[function(e,t,i){"use strict";var n=e("./Device"),o=function(){function e(e){this.deviceDetector=e}return e.prototype.build=function(e,t){var i=new n.Device;this.deviceDetector.detect(i),e.device=i},e}();i.DeviceBuilder=o},{"./Device":33}],35:[function(e,t,i){"use strict";var n=function(){function e(){this.detectors=[]}return e.prototype.addDetector=function(e){this.detectors.push(e)},e.prototype.detect=function(e){for(var t=0,i=this.detectors;t<i.length;t++){var n=i[t];n.detect(e)}this.device=e},e.prototype.getDevice=function(){return this.device},e}();i.DeviceDetector=n},{}],36:[function(e,t,i){"use strict";var n=function(){function e(){}return Object.defineProperty(e,"DEFAULT_EVENT",{get:function(){return"pageView"},enumerable:!0,configurable:!0}),e}();i.Event=n},{}],37:[function(e,t,i){"use strict";var n=e("./Event"),o=function(){function e(e){this.config=e}return e.prototype.build=function(e,t){var i=new n.Event;i.trackerId=this.config.trackerId,t.hasOwnProperty("event")?(i.name=t.event,delete t.event):i.name=n.Event.DEFAULT_EVENT,e.event=i},e}();i.EventBuilder=o},{"./Event":36}],38:[function(e,t,i){"use strict";var n=function(){function e(){this._customDimensions=[],this._customMetrics=[]}return e.prototype.addCustomDimension=function(e){this._customDimensions.push(e)},e.prototype.addCustomMetric=function(e){this._customMetrics.push(e)},Object.defineProperty(e.prototype,"customDimensions",{get:function(){return this._customDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"customMetrics",{get:function(){return this._customMetrics},enumerable:!0,configurable:!0}),e}();i.Model=n},{}],39:[function(e,t,i){"use strict";var n=function(){function e(){this.builders=[]}return e.prototype.addBuilder=function(e){this.builders.push(e)},e.prototype.build=function(e,t){for(var i=0,n=this.builders;i<n.length;i++){var o=n[i];o.build(e,t)}},e}();i.ModelBuilder=n},{}],40:[function(e,t,i){"use strict";var n=function(){function e(){}return e}();i.Visitor=n},{}],41:[function(e,t,i){"use strict";var n=e("./Visitor"),o=function(){function e(e){this.sessionManager=e}return e.prototype.build=function(e,t){var i=this.sessionManager.handle(),o=new n.Visitor;o.sessionId=i.session.sessionId,o.visitorId=i.visitor.visitorId,o.firstVisitAt=i.visitor.firstVisitAt.getTime(),o.currentVisitAt=i.visitor.lastVisitAt.getTime(),o.sessionStartedAt=i.session.sessionStartedAt.getTime(),o.sessionEndedAt=i.session.sessionEndedAt.getTime(),e.visitor=o},e}();i.VisitorBuilder=o},{"./Visitor":40}],42:[function(e,t,i){"use strict";var n=function(){function e(){}return e.prototype.normalize=function(e){var t={e:this.getEventName(e),l:this.getLanguage(e),t:this.getTrackerId(e),de:this.getDocumentEncoding(e),sr:this.getDeviceWidthAndHeight(e),sv:this.getDeviceAvailableWidthAndHeight(e),cd:this.getColorDepth(e),di:this.getDeviceHexInfo(e),dl:this.getDocumentLocation(e),dh:this.getDocumentHost(e),dp:this.getDocumentPath(e),dt:this.getDocumentTitle(e),cb:this.getCacheBuster(),vid:this.getVisitorId(e),sid:this.getSessionId(e),st:this.getSessionTime(e)};return this.setCustomDimension(t,e),this.setCustomMetrics(t,e),t},e.prototype.getDeviceHexInfo=function(e){var t="1"+Number(e.device.isLocalStorage)+Number(e.device.isSessionStorage)+Number(e.device.isAdBlock)+Number(e.device.isJavascript)+Number(e.device.isPdf)+Number(e.device.isCanvas)+Number(e.device.isFlash)+Number(e.device.isSilverlight)+Number(e.device.isCookie)+Number(e.device.isTouch)+Number(e.device.isQuickTime)+Number(e.device.isJava)+Number(e.device.isRealPlayer);return parseInt(t,2).toString(16)},e.prototype.getDeviceWidthAndHeight=function(e){return Number(e.device.width)+"x"+Number(e.device.height)},e.prototype.getDeviceAvailableWidthAndHeight=function(e){return Number(e.device.availableWidth)+"x"+Number(e.device.availableHeight)},e.prototype.getEventName=function(e){return e.event.name},e.prototype.getDocumentLocation=function(e){return e.content.location},e.prototype.getDocumentHost=function(e){return e.content.host},e.prototype.getDocumentPath=function(e){return e.content.path},e.prototype.getDocumentTitle=function(e){return e.content.title},e.prototype.getDocumentEncoding=function(e){return e.device.encoding},e.prototype.getColorDepth=function(e){return e.device.colors},e.prototype.getLanguage=function(e){return e.device.language},e.prototype.getTrackerId=function(e){return e.event.trackerId},e.prototype.getVisitorId=function(e){return e.visitor.visitorId},e.prototype.getSessionId=function(e){return e.visitor.sessionId},e.prototype.getSessionTime=function(e){var t=e.visitor;return t.firstVisitAt+"."+t.sessionStartedAt+"."+t.currentVisitAt+"."+t.sessionEndedAt},e.prototype.getCacheBuster=function(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,10)},e.prototype.setCustomDimension=function(e,t){for(;t.customDimensions.length>0;){var i=t.customDimensions.shift();e["cd["+i.index+"]"]=i.value}},e.prototype.setCustomMetrics=function(e,t){for(;t.customMetrics.length>0;){var i=t.customMetrics.shift();e["cm["+i.index+"]"]=i.value}},e}();i.ModelNormalizer=n},{}],43:[function(e,t,i){"use strict";var n=function(){function e(e){void 0===e&&(e=[]),this.elements=e}return e.prototype.consume=function(e){for(var t=0;t<this.elements.length;t++)e(t,this.elements[t])},e}();i.Queue=n},{}],44:[function(e,t,i){"use strict";var n=function(){function e(){}return e.prototype.serialize=function(e){return JSON.stringify(e)},e.prototype.deserialize=function(e){return JSON.parse(e)},e}();i.JsonSerializer=n},{}],45:[function(e,t,i){"use strict";var n=function(){function e(){}return e.prototype.serialize=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&encodeURIComponent(e[i])&&t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t.join("&")},e.prototype.deserialize=function(e){},e}();i.QueryStringSerializer=n},{}],46:[function(e,t,i){"use strict";var n=e("../Serializer/JsonSerializer"),o=e("../Serializer/QueryStringSerializer"),r=e("../Transport/Transports"),s=function(){function e(){}return e.prototype.createFromTransport=function(e){return e===r.Transports.PIXEL_TRANSPORT?new o.QueryStringSerializer:new n.JsonSerializer},e}();i.SerializerFactory=s},{"../Serializer/JsonSerializer":44,"../Serializer/QueryStringSerializer":45,"../Transport/Transports":60}],47:[function(e,t,i){"use strict";var n=e("../Session"),o=function(){function e(e,t){this.document=e,this.config=t}return e.prototype.serialize=function(e){return this.config.sessionCookieName+"="+e.sessionId+"."+e.sessionStartedAt.getTime()+"."+e.sessionEndedAt.getTime()+";max-age="+this.config.sessionLifetimeInSeconds},e.prototype.deserialize=function(){var e="; "+this.document.cookie,t=e.split("; "+this.config.sessionCookieName+"=");if(2===t.length){var i=t.pop().split(";").shift(),o=i.split(".");return n.Session.getExistingSession(o[0],Number(o[1]),Number(o[2]))}return null},e}();i.SessionCookieSerializer=o},{"../Session":49}],48:[function(e,t,i){"use strict";var n=e("../Visitor"),o=function(){function e(e,t){this.document=e,this.config=t}return e.prototype.serialize=function(e){return this.config.visitorCookieName+"="+e.visitorId+"."+e.firstVisitAt.getTime()+"."+e.lastVisitAt.getTime()+";max-age="+this.config.visitorLifetimeInSeconds},e.prototype.deserialize=function(){var e="; "+this.document.cookie,t=e.split("; "+this.config.visitorCookieName+"=");if(2===t.length){var i=t.pop().split(";").shift(),o=i.split(".");return n.Visitor.getCurrentVisitor(o[0],Number(o[1]),Number(o[2]))}return null},e}();i.VisitorCookieSerializer=o},{"../Visitor":54}],49:[function(e,t,i){"use strict";var n=e("../Common/Uuid"),o=function(){function e(e,t,i){this._sessionId=e,this._sessionStartedAt=t,this._sessionEndedAt=i}return e.createNewSession=function(t){return new e(n.Uuid.generate(),t,new Date(t.getTime()+18e5))},e.getExistingSession=function(t,i,n){return new e(t,new Date(i),new Date(n))},e.prototype.renewSession=function(e){this._sessionEndedAt=new Date(e.getTime()+18e5)},Object.defineProperty(e.prototype,"sessionId",{get:function(){return this._sessionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sessionStartedAt",{get:function(){return this._sessionStartedAt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sessionEndedAt",{get:function(){return this._sessionEndedAt},enumerable:!0,configurable:!0}),e}();i.Session=o},{"../Common/Uuid":4}],50:[function(e,t,i){"use strict";var n=e("./Session"),o=e("./Visitor"),r=function(){function e(e,t){this._session=e,this._visitor=t}return e.createNewSessionAndVisitor=function(){var t=new Date,i=n.Session.createNewSession(t),r=o.Visitor.createNewVisitor(t);return new e(i,r)},e.createNewSessionForExistingVisitor=function(t){var i=new Date,o=n.Session.createNewSession(i);return t.updateLastVisit(i),new e(o,t)},e.getExistingSession=function(t,i){var n=new Date;return t.updateLastVisit(n),i.renewSession(n),new e(i,t)},Object.defineProperty(e.prototype,"session",{get:function(){return this._session},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visitor",{get:function(){return this._visitor},enumerable:!0,configurable:!0}),e}();i.SessionAggregate=r},{"./Session":49,"./Visitor":54}],51:[function(e,t,i){"use strict";var n=e("./SessionAggregate"),o=e("./Session"),r=e("./Visitor"),s=function(){function e(e,t){this.sessionCookieStorage=e,this.visitorCookieStorage=t}return e.prototype.handle=function(){var e,t=this.sessionCookieStorage.find(),i=this.visitorCookieStorage.find();return e=t instanceof o.Session&&i instanceof r.Visitor?n.SessionAggregate.getExistingSession(i,t):!t&&i instanceof r.Visitor?n.SessionAggregate.createNewSessionForExistingVisitor(i):n.SessionAggregate.createNewSessionAndVisitor(),this.sessionCookieStorage.insert(e.session),this.visitorCookieStorage.insert(e.visitor),e},e}();i.SessionManager=s},{"./Session":49,"./SessionAggregate":50,"./Visitor":54}],52:[function(e,t,i){"use strict";var n=function(){function e(e,t){this.document=e,this.sessionCookieSerializer=t}return e.prototype.insert=function(e){this.document.cookie=this.sessionCookieSerializer.serialize(e)},e.prototype.find=function(){return this.sessionCookieSerializer.deserialize()},e}();i.SessionCookieStorage=n},{}],53:[function(e,t,i){"use strict";var n=function(){function e(e,t){this.document=e,this.visitorCookieSerializer=t}return e.prototype.insert=function(e){this.document.cookie=this.visitorCookieSerializer.serialize(e)},e.prototype.find=function(){return this.visitorCookieSerializer.deserialize()},e}();i.VisitorCookieStorage=n},{}],54:[function(e,t,i){"use strict";var n=e("../Common/Uuid"),o=function(){function e(e,t,i){this._visitorId=e,this._firstVisitAt=t,this._lastVisitAt=i}return e.createNewVisitor=function(t){return new e(n.Uuid.generate(),t,t)},e.getCurrentVisitor=function(t,i,n){return new e(t,new Date(i),new Date(n))},e.prototype.updateLastVisit=function(e){this._lastVisitAt=e},Object.defineProperty(e.prototype,"visitorId",{get:function(){return this._visitorId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstVisitAt",{get:function(){return this._firstVisitAt},enumerable:!0,configurable:!0
}),Object.defineProperty(e.prototype,"lastVisitAt",{get:function(){return this._lastVisitAt},enumerable:!0,configurable:!0}),e}();i.Visitor=o},{"../Common/Uuid":4}],55:[function(e,t,i){"use strict";var n=e("../Queue/Queue"),o=function(){function e(e,t,i){this.global=e,this.eventHandler=t,this.objectMerger=i}return Object.defineProperty(e,"SEND_COMMAND",{get:function(){return"send"},enumerable:!0,configurable:!0}),e.prototype.run=function(){var e=this;if(void 0!==this.global){var t=this.global,i=t.q,o=t.q.push;this.process(new n.Queue(i)),i.push=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];o.apply(i,Array.prototype.slice.call(t,0)),e.process(new n.Queue(i))}}},e.prototype.process=function(t){var i=this,n={};t.consume(function(t,o){o.length>=2&&(n=i.objectMerger.merge(n,o[1]),o[0]===e.SEND_COMMAND&&(i.global.q.splice(t,1),i.eventHandler.handle(n)))})},e}();i.Tracker=o},{"../Queue/Queue":43}],56:[function(e,t,i){"use strict";var n=function(){function e(e,t){this.navigator=e,this.config=t}return e.prototype.send=function(e){"function"==typeof this.navigator.sendBeacon&&this.navigator.sendBeacon(this.config.domain,e)},e}();i.BeaconTransport=n},{}],57:[function(e,t,i){"use strict";var n=function(){function e(e){this.config=e}return e.prototype.send=function(e){var t=new Image;t.src=this.config.domain+"/?"+e},e}();i.PixelTransport=n},{}],58:[function(e,t,i){"use strict";var n=function(){function e(e,t,i){this.transportFactory=e,this.serializerFactory=t,this.normalizer=i}return e.prototype.send=function(e,t){var i=this.transportFactory.create(e),n=this.serializerFactory.createFromTransport(e);i.send(n.serialize(this.normalizer.normalize(t)))},e}();i.Sender=n},{}],59:[function(e,t,i){"use strict";var n=e("./Transports"),o=function(){function e(e,t,i){this.xhrTransport=e,this.pixelTransport=t,this.beaconTransport=i}return e.prototype.create=function(e){switch(e){case n.Transports.XHR_TRANSPORT:return this.xhrTransport;case n.Transports.BEACON_TRANSPORT:return this.beaconTransport;case n.Transports.PIXEL_TRANSPORT:return this.pixelTransport;default:return this.pixelTransport}},e}();i.TransportFactory=o},{"./Transports":60}],60:[function(e,t,i){"use strict";!function(e){e[e.XHR_TRANSPORT=0]="XHR_TRANSPORT",e[e.BEACON_TRANSPORT=1]="BEACON_TRANSPORT",e[e.PIXEL_TRANSPORT=2]="PIXEL_TRANSPORT"}(i.Transports||(i.Transports={}));i.Transports},{}],61:[function(e,t,i){"use strict";var n=function(){function e(e){this.config=e}return e.prototype.send=function(e){var t=new XMLHttpRequest;t.open("POST",this.config.domain,!0),t.setRequestHeader("Content-Type","application/json"),t.send(e)},e}();i.XhrTransport=n},{}],62:[function(e,t,i){"use strict";var n=e("./DependencyInjection/Definition");n.container.get("w.tracker").run()},{"./DependencyInjection/Definition":8}]},{},[62])(62)});
